"use strict";(()=>{var e={};e.id=602,e.ids=[602],e.modules={53524:e=>{e.exports=require("@prisma/client")},67096:e=>{e.exports=require("bcrypt")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},86624:e=>{e.exports=require("querystring")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},65056:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>b,requestAsyncStorage:()=>f,routeModule:()=>w,serverHooks:()=>h,staticGenerationAsyncStorage:()=>q});var s={};r.r(s),r.d(s,{DELETE:()=>m,GET:()=>c,PUT:()=>x,dynamic:()=>l});var n=r(49303),i=r(88716),a=r(60670),o=r(87070),u=r(75571),p=r(95456),d=r(75748);let l="force-dynamic";async function c(e,{params:t}){try{let e=t.id,r=await d.db.post.findUnique({where:{id:parseInt(e)},include:{author:{select:{name:!0,email:!0}}}});if(!r)return new o.NextResponse("Post not found",{status:404});return o.NextResponse.json(r)}catch(e){return new o.NextResponse("Internal Server Error",{status:500})}}async function x(e,{params:t}){try{let r=await (0,u.getServerSession)((0,p.b)());if(!r)return new o.NextResponse("Unauthorized",{status:401});let s=t.id,{title:n,content:i}=await e.json();if(!n||!i)return new o.NextResponse("Missing title or content",{status:400});let a=await d.db.post.findUnique({where:{id:parseInt(s)}});if(!a)return new o.NextResponse("Post not found",{status:404});if(a.authorId!==r.user.id)return new o.NextResponse("Forbidden",{status:403});let l=await d.db.post.update({where:{id:parseInt(s)},data:{title:n,content:i}});return o.NextResponse.json(l)}catch(e){return new o.NextResponse("Internal Server Error",{status:500})}}async function m(e,{params:t}){try{let e=await (0,u.getServerSession)((0,p.b)());if(!e)return new o.NextResponse("Unauthorized",{status:401});let r=t.id,s=await d.db.post.findUnique({where:{id:parseInt(r)}});if(!s)return new o.NextResponse("Post not found",{status:404});if("ADMIN"!==e.user.role&&s.authorId!==e.user.id)return new o.NextResponse("Forbidden",{status:403});return await d.db.post.delete({where:{id:parseInt(r)}}),new o.NextResponse(null,{status:204})}catch(e){return new o.NextResponse("Internal Server Error",{status:500})}}let w=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/posts/[id]/route",pathname:"/api/posts/[id]",filename:"route",bundlePath:"app/api/posts/[id]/route"},resolvedPagePath:"C:\\Users\\windows10\\Desktop\\gemin\\src\\app\\api\\posts\\[id]\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:f,staticGenerationAsyncStorage:q,serverHooks:h}=w,v="/api/posts/[id]/route";function b(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:q})}},95456:(e,t,r)=>{r.d(t,{b:()=>p});var s=r(13539),n=r(53797),i=r(61653),a=r(75748),o=r(67096),u=r.n(o);function p(){return{adapter:"production"===process.env.VERCEL_ENV?void 0:(0,s.N)(a.db),session:{strategy:"jwt"},pages:{signIn:"/admin/login"},providers:[(0,n.Z)({name:"Credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let t=await a.db.user.findUnique({where:{email:e.email}});return t&&t.password&&await u().compare(e.password,t.password)?{id:`${t.id}`,email:t.email,name:t.name,role:t.role}:null}}),(0,i.Z)({clientId:process.env.KAKAO_CLIENT_ID,clientSecret:process.env.KAKAO_CLIENT_SECRET})],callbacks:{session:async({session:e,token:t})=>(t&&(e.user.id=t.id,e.user.name=t.name,e.user.email=t.email,e.user.role=t.role),e),jwt:async({token:e,user:t})=>(t&&(console.log("User object from provider:",t),e.id=t.id,e.name=t.name,e.email=t.email,e.role=t.role),e)},secret:process.env.NEXTAUTH_SECRET}}},75748:(e,t,r)=>{r.d(t,{db:()=>n});var s=r(53524);let n=global.prisma||new s.PrismaClient({log:["query"]})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,754,972],()=>r(65056));module.exports=s})();